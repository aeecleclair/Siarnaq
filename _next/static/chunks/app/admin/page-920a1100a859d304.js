(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{9261:function(e,s,t){Promise.resolve().then(t.bind(t,9694))},9694:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return eQ}});var l=t(7437),a=t(692),r=t(4032),n=t(3363),i=t(7209),d=t(9772);let c=d.z.object({name:d.z.string({required_error:"Veuillez renseigner le nom de la variante"}).min(1,{message:"Veuillez renseigner le nom de la variante"})});var o=t(1014),u=t(2265),m=t(9343);let x=e=>{let{setRefetchCurriculum:s}=e,[t,d]=(0,u.useState)(!1),x=(0,m.cI)({resolver:(0,o.F)(c),mode:"onBlur",defaultValues:{}});async function f(e){d(!0);let t={...e},{data:l,error:r}=await (0,a.hRe)({body:t});if(r){console.log(r),d(!1);return}s(!0),d(!1),x.reset({name:""})}return(0,l.jsx)(n.l0,{...x,children:(0,l.jsx)("form",{onSubmit:x.handleSubmit(f),children:(0,l.jsxs)("div",{className:"w-full flex flex-row gap-4 p-1 pr-0",children:[(0,l.jsx)(n.Wi,{control:x.control,name:"name",render:e=>{let{field:s}=e;return(0,l.jsx)(n.xJ,{className:"w-full",children:(0,l.jsx)(n.NI,{children:(0,l.jsx)(i.I,{...s,type:"text",placeholder:"Nom du cursus"})})})}}),(0,l.jsx)(r.f,{variant:"outline",type:"submit",isLoading:t,className:"w-[100px]",children:"Ajouter"})]})})})};var f=t(4008);let h=e=>{let{curriculum:s,setRefetchCurriculum:t}=e,[n,i]=(0,u.useState)(!1);async function d(e){i(!0);let{data:s,error:l}=await (0,a.QA_)({path:{curriculum_id:e}});if(l){console.log(l),i(!1);return}t(!0),i(!1)}return(0,l.jsxs)("div",{className:"flex flex-row items-center",children:[(0,l.jsx)(r.f,{size:"icon",variant:"destructive",className:"h-8",isLoading:n,onClick:()=>d(s.id),children:(0,l.jsx)(f._YF,{className:"w-5 h-5"})}),(0,l.jsx)("span",{className:"ml-4",children:s.name})]},s.id)};var p=t(5265);let g=()=>{let[e,s]=(0,u.useState)([]),[t,r]=(0,u.useState)(!0),n=async()=>{let{data:e,error:t}=await (0,a.kHc)({});if(t){console.log(t);return}s(e)};return(0,u.useEffect)(()=>{t&&r(e=>(n(),!1))},[t]),(0,l.jsxs)(p.Qd,{value:"curriculum",children:[(0,l.jsx)(p.o4,{children:(0,l.jsx)("div",{className:"flex flex-col items-start justify-between",children:(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"Cursus"})})}),(0,l.jsxs)(p.vF,{className:"space-y-2",children:[(0,l.jsx)(x,{setRefetchCurriculum:r}),e.map(e=>(0,l.jsx)(h,{curriculum:e,setRefetchCurriculum:r},e.id))]})]})},j=e=>{let{group:s,sellers:t,setRefetchGroups:n,setRefetchSellers:i}=e,[d,c]=(0,u.useState)(!1),o=t.map(e=>e.group_id);async function m(e){c(!0);let s={group_id:e.id,name:e.name,order:t.length+1},{data:l,error:r}=await (0,a.sKK)({body:s});if(r){console.log(r),c(!1);return}n(!0),i(!0),c(!1)}async function x(e){c(!0);let{data:s,error:t}=await (0,a.vJT)({path:{seller_id:e}});if(t){console.log(t),c(!1);return}n(!0),i(!0),c(!1)}return(0,l.jsxs)("div",{className:"flex flex-row items-center",children:[o.includes(s.id)?(0,l.jsx)(r.f,{size:"icon",variant:"destructive",className:"h-8",isLoading:d,onClick:()=>x(t.find(e=>e.group_id===s.id).id),children:(0,l.jsx)(f._YF,{className:"w-5 h-5"})}):(0,l.jsx)(r.f,{variant:"outline",size:"icon",className:"h-8",isLoading:d,onClick:()=>m(s),children:(0,l.jsx)(f.b9W,{className:"w-5 h-5"})}),(0,l.jsx)("span",{className:"ml-4",children:s.name})]},s.id)},v=e=>{let{sellers:s,setRefetchSellers:t}=e,[r,n]=(0,u.useState)([]),[i,d]=(0,u.useState)(!0),c=async()=>{let{data:e,error:s}=await (0,a.jA4)({});if(s){console.log(s);return}n(e)};return(0,u.useEffect)(()=>{i&&d(e=>(c(),!1))},[i]),(0,l.jsxs)(p.Qd,{value:"association",children:[(0,l.jsx)(p.o4,{children:(0,l.jsx)("div",{className:"flex flex-col items-start justify-between",children:(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"Association"})})}),(0,l.jsx)(p.vF,{className:"space-y-2",children:r.map(e=>(0,l.jsx)(j,{group:e,sellers:s,setRefetchGroups:d,setRefetchSellers:t},e.id))})]})},N=e=>{let{status:s,setRefetchStatus:t}=e,[n,i]=(0,u.useState)(!1),d=async e=>{i(!0);let{data:s,error:l}=await (0,a.kb4)({body:{status:e}});if(l){console.log(l),i(!1);return}t(!0),i(!1)},c={pending:"online",online:"onsite",onsite:"closed",closed:"pending"};return(0,l.jsxs)(p.Qd,{value:"status",children:[(0,l.jsx)(p.o4,{children:(0,l.jsx)("div",{className:"flex flex-col items-start justify-between",children:(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"Status"})})}),(0,l.jsx)(p.vF,{className:"space-y-2",children:s&&(0,l.jsxs)("div",{className:"flex flex-row space-y-2 justify-between items-center w-full",children:[(0,l.jsx)("span",{children:{pending:"En attente",online:"En ligne",onsite:"Sur place",closed:"Ferm\xe9"}[s.status]}),(0,l.jsx)(r.f,{onClick:()=>d(c[s.status]),isLoading:n,className:"w-[130px]",children:{pending:"R\xe9initialiser",online:"Mettre en ligne",onsite:"Sur place",closed:"Fermer"}[c[s.status]]})]})})]})},w=e=>{let{sellers:s,setRefetchSellers:t,status:a,setRefetchStatus:r}=e;return(0,l.jsxs)(p.UQ,{type:"multiple",children:[(0,l.jsx)(v,{sellers:s,setRefetchSellers:t}),(0,l.jsx)(g,{}),(0,l.jsx)(N,{status:a,setRefetchStatus:r})]})};var b=t(2625),y=t(2140),S=t(2272),C=t(9733),R=t(8185),z=t(402),k=t(9888),F=t(9973),_=t(6943),P=t(6898),V=t(9196);let I=e=>{var s,t,n,i;let{user:d,refetch:c}=e,{total:o}=(0,P.T)(d.id),{total:m}=(0,V.$)(d.id),{curriculums:x}=(0,_.M)(),[h,p]=(0,u.useState)(!1),[g,j]=(0,u.useState)(!1),v=!!(null===(s=d.curriculum)||void 0===s?void 0:s.id),[N,w]=(0,u.useState)(null===(t=d.curriculum)||void 0===t?void 0:t.id);async function I(){var e;if(j(!0),!N){j(!1),p(!1);return}if(v){let{data:s,error:t}=await (0,a.gKZ)({path:{user_id:d.id,curriculum_id:N}});e=t}else{let{data:s,error:t}=await (0,a.Vum)({path:{user_id:d.id,curriculum_id:N}});e=t}if(e){console.log(e),j(!1),p(!1);return}c(),p(!1),j(!1)}return(0,l.jsxs)("div",{className:"grid gap-12 pt-8",children:[(0,l.jsxs)("div",{className:"space-y-8",children:[(0,l.jsxs)(R.ll,{className:"flex flex-row justify-between items-center",children:[(0,l.jsx)("div",{children:d.nickname?(0,l.jsxs)("span",{className:"font-bold",children:[d.nickname," (",d.firstname," ",d.name,")"]}):(0,l.jsxs)("span",{className:"font-bold",children:[d.firstname," ",d.name]})}),(0,l.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,l.jsx)("span",{className:"font-semibold text-base",children:null!==(i=null===(n=d.curriculum)||void 0===n?void 0:n.name)&&void 0!==i?i:"Pas de cursus"}),(0,l.jsx)(S.Q,{isOpened:h,setIsOpened:p,title:"Modifier le cursus",description:(0,l.jsxs)("div",{className:"grid gap-6 mt-4",children:[(0,l.jsxs)("div",{className:"grid gap-2",children:[(0,l.jsx)(z._,{children:"Cursus"}),(0,l.jsxs)(k.Ph,{onValueChange:w,defaultValue:N,children:[(0,l.jsx)(k.i4,{children:(0,l.jsx)(k.ki,{})}),(0,l.jsx)(k.Bw,{side:"top",children:null==x?void 0:x.map(e=>(0,l.jsx)(k.Ql,{value:e.id,children:(0,l.jsx)("div",{className:"flex items-center flex-row gap-2",children:e.name})},e.id))})]})]}),(0,l.jsxs)("div",{className:"flex justify-end mt-2 space-x-4",children:[(0,l.jsx)(C.z,{variant:"outline",onClick:function(e){e.stopPropagation(),p(!1)},disabled:g,className:"w-[100px]",children:"Annuler"}),(0,l.jsx)(r.f,{isLoading:g,className:"w-[100px]",type:"button",onClick:I,children:"Modifier"})]})]}),children:(0,l.jsx)(C.z,{size:"icon",variant:"outline",className:"w-[40px]",children:(0,l.jsx)(f._vs,{className:"h-5 w-5"})})})]})]}),(0,l.jsx)(F.Z,{})]}),(0,l.jsx)(y.q,{user:d}),(0,l.jsx)(b.X,{user:d,isAdmin:!0}),(0,l.jsx)("div",{className:"grid gap-6",children:(0,l.jsxs)(R.ll,{className:"flex flex-row w-full",children:[(0,l.jsx)("span",{className:"font-bold",children:"Reste \xe0 payer"}),(0,l.jsxs)("span",{className:"ml-auto font-semibold",children:[(null!=m?m:0)-(null!=o?o:0)," â‚¬"]})]})})]})};var A=t(8777),M=t(5390);let E=e=>{let{seller:s,refreshProduct:t}=e,[r,i]=(0,u.useState)(!1),[d,c]=(0,u.useState)(!1),x=(0,m.cI)({resolver:(0,o.F)(M.k),mode:"onBlur",defaultValues:{product_constraints:[],document_constraints:[]}});async function h(e){c(!0);let l={...e,available_online:"true"===e.available_online},{data:r,error:n}=await (0,a.NxE)({path:{seller_id:s.id},body:l});if(n){console.log(n),c(!1),i(!1);return}t(),i(!1),c(!1),x.reset()}return(0,l.jsx)(S.Q,{title:"Nouveau produit",description:(0,l.jsx)(n.l0,{...x,children:(0,l.jsx)("form",{onSubmit:x.handleSubmit(h),children:(0,l.jsx)(A.G,{form:x,setIsOpened:i,isLoading:d})})}),isOpened:r,setIsOpened:i,children:(0,l.jsxs)("div",{className:"flex flex-1 items-center justify-start py-4 font-medium border-b cursor-pointer",children:[(0,l.jsx)(f.b9W,{className:"w-4 h-4 mr-6"}),(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"New Product"})]})})};var L=t(4633),Z=t(2447),T=t(9354);let q=Z.fC,G=u.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,l.jsx)(Z.aV,{ref:s,className:(0,T.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...a})});G.displayName=Z.aV.displayName;let U=u.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,l.jsx)(Z.xz,{ref:s,className:(0,T.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...a})});U.displayName=Z.xz.displayName;let K=u.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,l.jsx)(Z.VY,{ref:s,className:(0,T.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...a})});K.displayName=Z.VY.displayName;var Q=t(7911),O=t(6463);let H=e=>{let{status:s,seller:t,products:a,refetchProducts:r}=e,n=(0,O.useSearchParams)(),i=n.get("sellerId"),d=n.get("userId"),{productExpansion:c,setExpandedProducts:o}=(0,Q.g)();return(0,u.useEffect)(()=>{void 0===c[t.id]&&t.id===i&&a&&o(t.id,a.map(e=>e.id))},[c,t.id,o,a,i]),(0,l.jsxs)(K,{value:t.id,className:"min-w-96",children:[(0,l.jsx)(E,{seller:t,refreshProduct:r}),a?(0,l.jsx)(p.UQ,{type:"multiple",value:c[t.id],onValueChange:e=>o(t.id,e),children:a.map(e=>(0,l.jsx)(L.A,{product:e,sellerId:t.id,userId:d,canAdd:"closed"!==s.status,canEdit:"pending"===s.status,canRemove:"pending"===s.status,canDisable:"closed"!==s.status,refreshProduct:r,isSelectable:"onsite"===s.status,isAdmin:!0},e.id))}):(0,l.jsx)("div",{className:"p-4 border border-gray-200 rounded-md",children:(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"No products found"})})]})};var Y=t(7948),D=t(5355);let B=e=>{let{isTokenExpired:s}=(0,Y.d)(),{data:t,isLoading:l,refetch:r}=(0,D.a)({queryKey:["sellerProducts",null!=e?e:""],queryFn:()=>(0,a.MgL)({path:{seller_id:e}}),retry:3,enabled:!s()&&!!e});return{products:null==t?void 0:t.data,isLoading:l,refetch:r}};var J=t(7042);let W=e=>{let{status:s,setRefetchStatus:t,sellers:a,setRefetchSellers:r,isAdmin:n}=e,i=(0,O.useSearchParams)(),d=i.get("sellerId"),{products:c,refetch:o}=B(["cdradmin","cdrrecap"].includes(null!=d?d:"")?null:d),u=i.get("userId"),{user:m,refetch:x}=(0,J.a)(u);return"cdradmin"===d&&n?(0,l.jsx)(w,{sellers:a,setRefetchSellers:r,status:s,setRefetchStatus:t}):"cdrrecap"===d&&n?m&&(0,l.jsx)(I,{user:m,refetch:x}):a.map(e=>(0,l.jsx)(H,{seller:e,status:s,products:c,refetchProducts:o},e.id))},X=e=>{let{status:s,sellers:t,isAdmin:a}=e,r=(0,O.useRouter)(),n=(0,O.useSearchParams)(),i=e=>{let s=new URLSearchParams(Array.from(n.entries()));s.set("sellerId",e);let t=s.toString();r.push("admin?".concat(t))};return(0,l.jsxs)(G,{className:'"grid w-full grid-cols-'.concat(t.length+(a?1:0)+("onsite"===s.status&&a?1:0),'"'),children:[t.map(e=>(0,l.jsx)(U,{value:e.id,className:"w-full min-w-18",onClick:()=>i(e.id),children:e.name},e.id)),a&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(U,{value:"cdradmin",className:"w-full min-w-18",onClick:()=>i("cdradmin"),children:"Admin"},"cdradmin"),"onsite"===s.status&&(0,l.jsx)(U,{value:"cdrrecap",className:"w-full min-w-18",onClick:()=>i("cdrrecap"),children:"R\xe9caputilatif"},"cdrrecap")]})]})};var $=t(7061);let ee=()=>{var e,s;let{isTokenExpired:t}=(0,Y.d)(),{userId:l}=(0,$.u)(),{data:r,isLoading:n,refetch:i}=(0,D.a)({queryKey:["coreUser",null!=l?l:""],queryFn:()=>(0,a.o87)({path:{user_id:l}}),retry:3,enabled:!t()&&!!l});return{user:null==r?void 0:r.data,isAdmin:null==r?void 0:null===(s=r.data)||void 0===s?void 0:null===(e=s.groups)||void 0===e?void 0:e.map(e=>e.id).includes("c1275229-46b2-4e53-a7c4-305513bb1a2a"),isLoading:n,refetch:i}},es=e=>{var s;let{status:t,setRefetchStatus:r}=e,{isAdmin:n}=ee(),i=(0,O.useSearchParams)(),d=(0,O.useRouter)(),[c,o]=(0,u.useState)([]),m=i.get("sellerId")||(null===(s=c.at(0))||void 0===s?void 0:s.id)||(n?"cdradmin":""),[x,f]=(0,u.useState)(!0);(0,u.useEffect)(()=>{if(!i.get("sellerId")&&c.length>0&&m){let e=new URLSearchParams(Array.from(i.entries()));e.set("sellerId",m);let s=e.toString();d.replace("admin?".concat(s))}},[m,d,i,c]);let h=async()=>{let{data:e,error:s}=await (0,a.wlZ)({});if(s){console.log(s);return}o(e)};return(0,u.useEffect)(()=>{x&&f(e=>(h(),!1))},[x]),(0,l.jsx)("div",{className:"flex items-center justify-center p-6 min-w-96",onLoad:h,children:m&&(0,l.jsxs)(q,{defaultValue:m,className:"w-full",children:[(0,l.jsx)(X,{status:t,sellers:c,isAdmin:n}),(0,l.jsx)(W,{status:t,setRefetchStatus:r,sellers:c,setRefetchSellers:f,isAdmin:n})]})})};var et=t(4971),el=t(7592),ea=t(2468),er=t(8165);let en=et.fC,ei=et.xz;et.ZA,et.Uv,et.Tr,et.Ee,u.forwardRef((e,s)=>{let{className:t,inset:a,children:r,...n}=e;return(0,l.jsxs)(et.fF,{ref:s,className:(0,T.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",a&&"pl-8",t),...n,children:[r,(0,l.jsx)(el.Z,{className:"ml-auto h-4 w-4"})]})}).displayName=et.fF.displayName,u.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,l.jsx)(et.tu,{ref:s,className:(0,T.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...a})}).displayName=et.tu.displayName;let ed=u.forwardRef((e,s)=>{let{className:t,sideOffset:a=4,...r}=e;return(0,l.jsx)(et.Uv,{children:(0,l.jsx)(et.VY,{ref:s,sideOffset:a,className:(0,T.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})})});ed.displayName=et.VY.displayName;let ec=u.forwardRef((e,s)=>{let{className:t,inset:a,...r}=e;return(0,l.jsx)(et.ck,{ref:s,className:(0,T.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a&&"pl-8",t),...r})});ec.displayName=et.ck.displayName;let eo=u.forwardRef((e,s)=>{let{className:t,children:a,checked:r,...n}=e;return(0,l.jsxs)(et.oC,{ref:s,className:(0,T.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:r,...n,children:[(0,l.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,l.jsx)(et.wU,{children:(0,l.jsx)(ea.Z,{className:"h-4 w-4"})})}),a]})});eo.displayName=et.oC.displayName,u.forwardRef((e,s)=>{let{className:t,children:a,...r}=e;return(0,l.jsxs)(et.Rk,{ref:s,className:(0,T.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[(0,l.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,l.jsx)(et.wU,{children:(0,l.jsx)(er.Z,{className:"h-2 w-2 fill-current"})})}),a]})}).displayName=et.Rk.displayName;let eu=u.forwardRef((e,s)=>{let{className:t,inset:a,...r}=e;return(0,l.jsx)(et.__,{ref:s,className:(0,T.cn)("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",t),...r})});eu.displayName=et.__.displayName;let em=u.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,l.jsx)(et.Z0,{ref:s,className:(0,T.cn)("-mx-1 my-1 h-px bg-muted",t),...a})});em.displayName=et.Z0.displayName;var ex=t(4867);function ef(e){let{column:s,title:t,className:a}=e;return s.getCanSort()?(0,l.jsx)("div",{className:(0,T.cn)("flex items-center space-x-2",a),children:(0,l.jsxs)(en,{children:[(0,l.jsx)(ei,{asChild:!0,children:(0,l.jsxs)(C.z,{variant:"ghost",size:"sm",className:"-ml-3 h-8 data-[state=open]:bg-accent -mr-7",children:[(0,l.jsx)("span",{children:t}),"desc"===s.getIsSorted()?(0,l.jsx)(ex.veu,{className:"ml-2 h-4 w-4"}):"asc"===s.getIsSorted()?(0,l.jsx)(ex.Hf3,{className:"ml-2 h-4 w-4"}):(0,l.jsx)(ex.jnn,{className:"ml-2 h-4 w-4"})]})}),(0,l.jsxs)(ed,{align:"start",children:[(0,l.jsxs)(ec,{onClick:()=>s.toggleSorting(!1),children:[(0,l.jsx)(ex.Hf3,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Asc"]}),(0,l.jsxs)(ec,{onClick:()=>s.toggleSorting(!0),children:[(0,l.jsx)(ex.veu,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Desc"]}),(0,l.jsx)(em,{}),(0,l.jsxs)(ec,{onClick:()=>s.toggleVisibility(!1),children:[(0,l.jsx)(ex.L52,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Cacher"]})]})]})}):(0,l.jsx)("div",{className:(0,T.cn)(a),children:t})}var eh=t(3541),ep=t(4175);let eg=(e,s,t)=>{let l=0;if(e.columnFiltersMeta[t]){var a,r;l=(0,eh.S1)(null===(a=e.columnFiltersMeta[t])||void 0===a?void 0:a.itemRank,null===(r=s.columnFiltersMeta[t])||void 0===r?void 0:r.itemRank)}return 0===l?ep.V2.alphanumeric(e,s,t):l},ej=(e,s,t,l)=>{let a=(0,eh.O4)(e.getValue(s),t);return l({itemRank:a}),a.passed};var ev=t(9055);let eN=[{accessorKey:"name",header:e=>{let{column:s}=e;return(0,l.jsx)(ef,{column:s,title:"Nom"})},cell:e=>{let{row:s}=e;return(0,l.jsx)("div",{children:s.getValue("name")})},enableSorting:!1,filterFn:"fuzzy",sortingFn:eg},{accessorKey:"firstname",header:e=>{let{column:s}=e;return(0,l.jsx)(ef,{column:s,title:"Pr\xe9nom"})},cell:e=>{let{row:s}=e;return(0,l.jsx)("div",{children:s.getValue("firstname")})},enableSorting:!1,filterFn:"fuzzy",sortingFn:eg},{accessorKey:"nickname",header:e=>{let{column:s}=e;return(0,l.jsx)(ef,{column:s,title:"Surnom"})},cell:e=>{let{row:s}=e;return(0,l.jsx)("div",{children:s.getValue("nickname")})},enableSorting:!1,filterFn:"fuzzy",sortingFn:eg},{accessorKey:"curriculum",header:e=>{let{column:s}=e;return(0,l.jsx)(ef,{column:s,title:"Cursus"})},cell:e=>{let{row:s}=e;return(0,l.jsx)("div",{className:"flex space-x-2",children:(0,l.jsx)(ev.C,{variant:"outline",children:s.getValue("curriculum")?s.getValue("curriculum").name:"Aucun cursus"})})},filterFn:(e,s,t)=>e.getValue(s)?t.includes(e.getValue(s).id):t.includes("")}];function ew(e){let{table:s}=e;return(0,l.jsxs)("div",{className:"flex items-center justify-between px-2",children:[(0,l.jsxs)("div",{className:"flex-1 text-sm text-muted-foreground min-w-[110px]",children:[s.getFilteredSelectedRowModel().rows.length," s\xe9l\xe9ctionn\xe9s"]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2 lg:space-x-3",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2 min-w-[140px]",children:[(0,l.jsxs)(k.Ph,{value:"".concat(s.getState().pagination.pageSize),onValueChange:e=>{s.setPageSize(Number(e))},children:[(0,l.jsx)(k.i4,{className:"h-8 w-[70px] min-w-[70px]",children:(0,l.jsx)(k.ki,{placeholder:s.getState().pagination.pageSize})}),(0,l.jsx)(k.Bw,{side:"top",children:[10,25,50,100].map(e=>(0,l.jsx)(k.Ql,{value:"".concat(e),children:e},e))})]}),(0,l.jsx)("p",{className:"text-sm font-medium",children:"par page"})]}),(0,l.jsxs)("div",{className:"flex w-[100px] items-center justify-center text-sm font-medium",children:["Page ",s.getState().pagination.pageIndex+1," sur"," ",s.getPageCount()]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsxs)(C.z,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>s.setPageIndex(0),disabled:!s.getCanPreviousPage(),children:[(0,l.jsx)("span",{className:"sr-only",children:"Go to first page"}),(0,l.jsx)(ex.kRt,{className:"h-4 w-4"})]}),(0,l.jsxs)(C.z,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>s.previousPage(),disabled:!s.getCanPreviousPage(),children:[(0,l.jsx)("span",{className:"sr-only",children:"Go to previous page"}),(0,l.jsx)(ex.wyc,{className:"h-4 w-4"})]}),(0,l.jsxs)(C.z,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>s.nextPage(),disabled:!s.getCanNextPage(),children:[(0,l.jsx)("span",{className:"sr-only",children:"Go to next page"}),(0,l.jsx)(ex.XCv,{className:"h-4 w-4"})]}),(0,l.jsxs)(C.z,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>s.setPageIndex(s.getPageCount()-1),disabled:!s.getCanNextPage(),children:[(0,l.jsx)("span",{className:"sr-only",children:"Go to last page"}),(0,l.jsx)(ex.yr4,{className:"h-4 w-4"})]})]})]})]})}var eb=t(4063),ey=t(1413);function eS(e){let{column:s,title:t,options:a}=e,r=null==s?void 0:s.getFacetedUniqueValues(),n=new Set(null==s?void 0:s.getFilterValue());return(0,l.jsxs)(ey.J2,{children:[(0,l.jsx)(ey.xo,{asChild:!0,children:(0,l.jsxs)(C.z,{variant:"outline",size:"sm",className:"h-8 border-dashed",children:[(0,l.jsx)(ex.SPS,{className:"mr-2 h-4 w-4"}),t,(null==n?void 0:n.size)>0&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(F.Z,{orientation:"vertical",className:"mx-2 h-4"}),(0,l.jsx)(ev.C,{variant:"secondary",className:"rounded-sm px-1 font-normal lg:hidden",children:n.size}),(0,l.jsx)("div",{className:"hidden space-x-1 lg:flex",children:n.size>2?(0,l.jsxs)(ev.C,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:[n.size," s\xe9lectionn\xe9s"]}):a.filter(e=>n.has(e.value)).map(e=>(0,l.jsx)(ev.C,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:e.label},e.value))})]})]})}),(0,l.jsx)(ey.yk,{className:"w-[200px] p-0",align:"start",children:(0,l.jsxs)(eb.mY,{children:[(0,l.jsx)(eb.sZ,{placeholder:t}),(0,l.jsxs)(eb.e8,{children:[(0,l.jsx)(eb.rb,{children:"Aucun r\xe9sultat"}),(0,l.jsx)(eb.fu,{children:a.map(e=>{let t=n.has(e.value);return(0,l.jsxs)(eb.di,{onSelect:()=>{t?n.delete(e.value):n.add(e.value);let l=Array.from(n);null==s||s.setFilterValue(l.length?l:void 0)},children:[(0,l.jsx)("div",{className:(0,T.cn)("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",t?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:(0,l.jsx)(ex.nQG,{className:(0,T.cn)("h-4 w-4")})}),e.icon&&(0,l.jsx)(e.icon,{className:"mr-2 h-4 w-4 text-muted-foreground"}),(0,l.jsx)("span",{children:e.label}),(null==r?void 0:r.get(e.value))&&(0,l.jsx)("span",{className:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs",children:r.get(e.value)})]},e.value)})}),n.size>0&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(eb.zz,{}),(0,l.jsx)(eb.fu,{children:(0,l.jsx)(eb.di,{onSelect:()=>null==s?void 0:s.setFilterValue(void 0),className:"justify-center text-center",children:"Supprimer les filtres"})})]})]})]})})]})}function eC(e){let{table:s}=e;return(0,l.jsxs)(en,{children:[(0,l.jsx)(et.$F,{asChild:!0,children:(0,l.jsxs)(C.z,{variant:"outline",size:"sm",className:"ml-auto hidden h-8 lg:flex",children:[(0,l.jsx)(ex.hsZ,{className:"mr-2 h-4 w-4"}),"Colonnes"]})}),(0,l.jsxs)(ed,{align:"end",className:"w-[180px]",children:[(0,l.jsx)(eu,{children:"Activer les colonnes"}),(0,l.jsx)(em,{}),s.getAllColumns().filter(e=>void 0!==e.accessorFn&&e.getCanHide()).map(e=>(0,l.jsx)(eo,{checked:e.getIsVisible(),onCheckedChange:s=>e.toggleVisibility(!!s),children:e.id},e.id))]})]})}function eR(e){let{table:s,globalFilter:t,setGlobalFilter:a}=e,{curriculums:r}=(0,_.M)();return(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex flex-1 items-center space-x-2",children:[(0,l.jsx)(i.I,{placeholder:"Filtrer",value:t,onChange:e=>a(e.target.value),className:"h-8 w-[150px] lg:w-[250px]"}),s.getColumn("curriculum")&&(0,l.jsx)(eS,{column:s.getColumn("curriculum"),title:"Cursus",options:((null==r?void 0:r.map(e=>({value:e.id,label:e.name})))||[]).concat({value:"",label:"Aucun cursus"})})]}),(0,l.jsx)(eC,{table:s})]})}let ez=u.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,l.jsx)("div",{className:"relative w-full overflow-auto",children:(0,l.jsx)("table",{ref:s,className:(0,T.cn)("w-full caption-bottom text-sm",t),...a})})});ez.displayName="Table";let ek=u.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,l.jsx)("thead",{ref:s,className:(0,T.cn)("[&_tr]:border-b",t),...a})});ek.displayName="TableHeader";let eF=u.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,l.jsx)("tbody",{ref:s,className:(0,T.cn)("[&_tr:last-child]:border-0",t),...a})});eF.displayName="TableBody",u.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,l.jsx)("tfoot",{ref:s,className:(0,T.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...a})}).displayName="TableFooter";let e_=u.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,l.jsx)("tr",{ref:s,className:(0,T.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted data-[state=selected]:font-semibold",t),...a})});e_.displayName="TableRow";let eP=u.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,l.jsx)("th",{ref:s,className:(0,T.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...a})});eP.displayName="TableHead";let eV=u.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,l.jsx)("td",{ref:s,className:(0,T.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...a})});eV.displayName="TableCell",u.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,l.jsx)("caption",{ref:s,className:(0,T.cn)("mt-4 text-sm text-muted-foreground",t),...a})}).displayName="TableCaption";var eI=t(3514);function eA(e){var s;let{columns:t,data:a}=e,r=(0,O.useRouter)(),n=(0,O.useSearchParams)(),[i,d]=u.useState({}),[c,o]=u.useState({}),[m,x]=u.useState([]),[f,h]=u.useState(""),[p,g]=u.useState([]),j=n.get("userId"),v=(0,eI.b7)({data:a,columns:t,filterFns:{fuzzy:ej},state:{columnFilters:m,globalFilter:f,sorting:p,columnVisibility:c,rowSelection:i},enableRowSelection:!0,onRowSelectionChange:d,onSortingChange:g,onColumnFiltersChange:x,onColumnVisibilityChange:o,getCoreRowModel:(0,ep.sC)(),getFilteredRowModel:(0,ep.vL)(),getPaginationRowModel:(0,ep.G_)(),getSortedRowModel:(0,ep.tj)(),getFacetedRowModel:(0,ep.o6)(),getFacetedUniqueValues:(0,ep.JG)(),globalFilterFn:"fuzzy",onGlobalFilterChange:h});function N(e){console.log("ok");let s=e.original.id,t=new URLSearchParams(Array.from(n.entries()));t.set("userId",s);let l=t.toString();r.push("/admin?".concat(l)),v.toggleAllRowsSelected(!1),e.toggleSelected(!0)}return u.useEffect(()=>{if(j&&v.getRowModel().rows.length>0){let e=v.getRowModel().rows.find(e=>e.original.id===j);e&&!e.getIsSelected()&&e.toggleSelected(!0)}},[v.getRowModel().rows,j]),(0,l.jsxs)("div",{className:"space-y-4 w-full",children:[(0,l.jsx)(eR,{table:v,globalFilter:f,setGlobalFilter:h}),(0,l.jsx)("div",{className:"rounded-md border",children:(0,l.jsxs)(ez,{children:[(0,l.jsx)(ek,{children:v.getHeaderGroups().map(e=>(0,l.jsx)(e_,{children:e.headers.map(e=>(0,l.jsx)(eP,{colSpan:e.colSpan,children:e.isPlaceholder?null:(0,eI.ie)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,l.jsx)(eF,{children:(null===(s=v.getRowModel().rows)||void 0===s?void 0:s.length)?(0,l.jsxs)(l.Fragment,{children:[v.getSelectedRowModel().rows.filter(e=>!v.getRowModel().rows.includes(e)).map(e=>(0,l.jsx)(e_,{"data-state":"selected",onClick:()=>N(e),children:e.getVisibleCells().map(e=>(0,l.jsx)(eV,{children:(0,eI.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)),v.getRowModel().rows.map(e=>(0,l.jsx)(e_,{"data-state":e.getIsSelected()&&"selected",onClick:()=>N(e),children:e.getVisibleCells().map(e=>(0,l.jsx)(eV,{children:(0,eI.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id))]}):(0,l.jsx)(e_,{children:(0,l.jsx)(eV,{colSpan:t.length,className:"h-24 text-center",children:"Pas de r\xe9sultat"})})})]})}),(0,l.jsx)(ew,{table:v})]})}let eM=()=>{let{isTokenExpired:e}=(0,Y.d)(),{data:s,isLoading:t,refetch:l}=(0,D.a)({queryKey:["users"],queryFn:a.CTm,retry:3,enabled:!e()});return{users:null==s?void 0:s.data,isLoading:t,refetch:l}},eE=()=>{let{users:e}=eM();return(0,l.jsx)("div",{className:"flex items-center justify-center p-6 min-w-96",children:e&&(0,l.jsx)(eA,{columns:eN,data:e})})};var eL=t(1322),eZ=t(1505);let eT=e=>{let{className:s,...t}=e;return(0,l.jsx)(eZ.eh,{className:(0,T.cn)("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",s),...t})},eq=eZ.s_,eG=e=>{let{withHandle:s,className:t,...a}=e;return(0,l.jsx)(eZ.OT,{className:(0,T.cn)("relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",t),...a,children:s&&(0,l.jsx)("div",{className:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border",children:(0,l.jsx)(eL.Z,{className:"h-2.5 w-2.5"})})})},eU=()=>{let{isTokenExpired:e}=(0,Y.d)(),{data:s,isLoading:t,refetch:l}=(0,D.a)({queryKey:["sellers"],queryFn:a.wlZ,retry:3,enabled:!e()});return{sellers:null==s?void 0:s.data,isLoading:t,refetch:l}};var eK=t(9079),eQ=()=>{var e;let{setSize:s,size:t}=(0,eK.R)(),{user:r,isAdmin:n}=ee(),{sellers:i}=eU(),d=(0,O.useRouter)(),[c,o]=(0,u.useState)({}),[m,x]=(0,u.useState)(!0),f=null==r?void 0:null===(e=r.groups)||void 0===e?void 0:e.map(e=>e.id),h=null==f?void 0:f.some(e=>null==i?void 0:i.some(s=>s.group_id===e));return(0,u.useEffect)(()=>{!r||n||h||d.push("/")},[n,h,d,r]),(0,u.useEffect)(()=>{let e=async()=>{let{data:e,error:t}=await (0,a.Dy4)({});if(t){console.log(t);return}(null==e?void 0:e.status)&&("onsite"===e.status?s(50):s(100)),o(e)};m&&x(s=>(e(),!1))},[m,s,c.status]),(0,l.jsx)("main",{className:"grid flex-1 items-start gap-4 p-4 sm:px-6 sm:py-0 md:gap-8 mt-8",children:(0,l.jsx)(u.Suspense,{fallback:(0,l.jsx)("div",{children:"Loading..."}),children:(0,l.jsx)(R.Zb,{children:"onsite"===c.status?(0,l.jsxs)(eT,{direction:"horizontal",children:[(0,l.jsx)(eq,{defaultSize:100-t,minSize:10,children:(0,l.jsx)(eE,{})}),(0,l.jsx)(eG,{withHandle:!0}),(0,l.jsx)(eq,{defaultSize:t,minSize:10,onResize:s,children:(0,l.jsx)(es,{status:c,setRefetchStatus:x})})]}):(0,l.jsx)(es,{status:c,setRefetchStatus:x})})})})}}},function(e){e.O(0,[310,516,422,791,857,454,698,623,986,971,23,744],function(){return e(e.s=9261)}),_N_E=e.O()}]);
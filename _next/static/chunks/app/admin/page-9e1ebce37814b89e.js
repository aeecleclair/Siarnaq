(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{9261:function(e,s,t){Promise.resolve().then(t.bind(t,5134))},5134:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return e7}});var a=t(7437),l=t(2265),r=t(2447),i=t(9354);let n=r.fC,d=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.aV,{ref:s,className:(0,i.cn)("inline-flex items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...l})});d.displayName=r.aV.displayName;let o=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.xz,{ref:s,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...l})});o.displayName=r.xz.displayName;let c=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.VY,{ref:s,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...l})});c.displayName=r.VY.displayName;var u=t(692),m=t(5355),x=t(7948);let f=()=>{var e,s;let{isTokenExpired:t}=(0,x.d)(),{data:a,isLoading:l,refetch:r}=(0,m.a)({queryKey:["coreUser"],queryFn:u.WBt,retry:3,enabled:!t()});return{user:null==a?void 0:a.data,isAdmin:null==a?void 0:null===(s=a.data)||void 0===s?void 0:null===(e=s.groups)||void 0===e?void 0:e.map(e=>e.id).includes("c1275229-46b2-4e53-a7c4-305513bb1a2a"),isLoading:l,refetch:r}},p=()=>{let{isTokenExpired:e}=(0,x.d)(),{data:s,isLoading:t,refetch:a}=(0,m.a)({queryKey:["sellers"],queryFn:u.C$B,retry:3,enabled:!e()});return{sellers:(null==s?void 0:s.data)||[],isLoading:t,refetch:a}};var h=t(6463);let j=e=>{let{isTokenExpired:s}=(0,x.d)(),{data:t,isLoading:a,refetch:l}=(0,m.a)({queryKey:["sellerProducts",null!=e?e:""],queryFn:()=>(0,u.MgL)({path:{seller_id:e}}),retry:3,enabled:!s()&&!!e});return{products:(null==t?void 0:t.data)||[],isLoading:a,refetch:l}};var g=t(7042),v=t(5265),b=t(6943),N=t(4032),w=t(3363),y=t(7209),S=t(8068),C=t(9772);let k=C.z.object({name:C.z.string({required_error:"Veuillez renseigner le nom de la variante"}).min(1,{message:"Veuillez renseigner le nom de la variante"})});var z=t(1014),_=t(9343);let V=()=>{let{toast:e}=(0,S.pm)(),{refetch:s}=(0,b.M)(),[t,r]=(0,l.useState)(!1),i=(0,_.cI)({resolver:(0,z.F)(k),mode:"onBlur",defaultValues:{}});async function n(t){r(!0);let a={...t},{data:l,error:n}=await (0,u.hRe)({body:a});if(n){e({title:"Error",description:n.detail,variant:"destructive"}),r(!1);return}s(),r(!1),i.reset({name:""})}return(0,a.jsx)(w.l0,{...i,children:(0,a.jsx)("form",{onSubmit:i.handleSubmit(n),children:(0,a.jsxs)("div",{className:"w-full flex flex-row gap-4 p-1 pr-0",children:[(0,a.jsx)(w.Wi,{control:i.control,name:"name",render:e=>{let{field:s}=e;return(0,a.jsx)(w.xJ,{className:"w-full",children:(0,a.jsx)(w.NI,{children:(0,a.jsx)(y.I,{...s,type:"text",placeholder:"Nom du cursus"})})})}}),(0,a.jsx)(N.f,{variant:"outline",type:"submit",isLoading:t,className:"w-[100px]",children:"Ajouter"})]})})})};var R=t(1109);let F=e=>{let{curriculum:s}=e,{toast:t}=(0,S.pm)(),{refetch:r}=(0,b.M)(),[i,n]=(0,l.useState)(!1);async function d(e){n(!0);let{data:s,error:a}=await (0,u.QA_)({path:{curriculum_id:e}});if(a){t({title:"Error",description:a.detail,variant:"destructive"}),n(!1);return}r(),n(!1)}return(0,a.jsxs)("div",{className:"flex flex-row items-center",children:[(0,a.jsx)(N.f,{size:"icon",variant:"destructive",className:"h-8",isLoading:i,onClick:()=>d(s.id),children:(0,a.jsx)(R._YF,{className:"w-5 h-5"})}),(0,a.jsx)("span",{className:"ml-4",children:s.name})]},s.id)},P=()=>{let{curriculums:e}=(0,b.M)();return(0,a.jsxs)(v.Qd,{value:"curriculum",children:[(0,a.jsx)(v.o4,{children:(0,a.jsx)("div",{className:"flex flex-col items-start justify-between",children:(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Cursus"})})}),(0,a.jsxs)(v.vF,{className:"space-y-2",children:[(0,a.jsx)(V,{}),e.map(e=>(0,a.jsx)(F,{curriculum:e},e.id))]})]})},I=()=>{let{isTokenExpired:e}=(0,x.d)(),{data:s,isLoading:t,refetch:a}=(0,m.a)({queryKey:["groups"],queryFn:u.jA4,retry:3,enabled:!e()});return{groups:(null==s?void 0:s.data)||[],isLoading:t,refetch:a}},A=e=>{let{group:s,sellers:t}=e,{toast:r}=(0,S.pm)(),{refetch:i}=I(),{refetch:n}=p(),[d,o]=(0,l.useState)(!1),c=t.map(e=>e.group_id);async function m(e){o(!0);let s={group_id:e.id,name:e.name,order:t.length+1},{data:a,error:l}=await (0,u.sKK)({body:s});if(l){r({title:"Error",description:l.detail,variant:"destructive"}),o(!1);return}i(),n(),o(!1)}async function x(e){o(!0);let{data:s,error:t}=await (0,u.vJT)({path:{seller_id:e}});if(t){r({title:"Error",description:t.detail,variant:"destructive"}),o(!1);return}i(),n(),o(!1)}return(0,a.jsxs)("div",{className:"flex flex-row items-center",children:[c.includes(s.id)?(0,a.jsx)(N.f,{size:"icon",variant:"destructive",className:"h-8",isLoading:d,onClick:()=>x(t.find(e=>e.group_id===s.id).id),children:(0,a.jsx)(R._YF,{className:"w-5 h-5"})}):(0,a.jsx)(N.f,{variant:"outline",size:"icon",className:"h-8",isLoading:d,onClick:()=>m(s),children:(0,a.jsx)(R.b9W,{className:"w-5 h-5"})}),(0,a.jsx)("span",{className:"ml-4",children:s.name})]},s.id)},E=e=>{let{sellers:s}=e,{groups:t}=I();return(0,a.jsxs)(v.Qd,{value:"association",children:[(0,a.jsx)(v.o4,{children:(0,a.jsx)("div",{className:"flex flex-col items-start justify-between",children:(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Association"})})}),(0,a.jsx)(v.vF,{className:"space-y-2",children:t.map(e=>(0,a.jsx)(A,{group:e,sellers:s},e.id))})]})},M=()=>{let{isTokenExpired:e}=(0,x.d)(),{data:s,isLoading:t,refetch:a}=(0,m.a)({queryKey:["status"],queryFn:u.Dy4,retry:3,enabled:!e()});return{status:null==s?void 0:s.data,isLoading:t,refetch:a}},T=e=>{let{status:s}=e,{toast:t}=(0,S.pm)(),{refetch:r}=M(),[i,n]=(0,l.useState)(!1),d=async e=>{n(!0);let{data:s,error:a}=await (0,u.kb4)({body:{status:e}});if(a){t({title:"Error",description:a.detail,variant:"destructive"}),n(!1);return}r(),n(!1)},o={pending:"online",online:"onsite",onsite:"closed",closed:"pending"};return(0,a.jsxs)(v.Qd,{value:"status",children:[(0,a.jsx)(v.o4,{children:(0,a.jsx)("div",{className:"flex flex-col items-start justify-between",children:(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Status"})})}),(0,a.jsx)(v.vF,{className:"space-y-2",children:s&&(0,a.jsxs)("div",{className:"flex flex-row space-y-2 justify-between items-center w-full",children:[(0,a.jsx)("span",{children:{pending:"En attente",online:"En ligne",onsite:"Sur place",closed:"Ferm\xe9"}[s.status]}),(0,a.jsx)(N.f,{onClick:()=>d(o[s.status]),isLoading:i,className:"w-[130px]",children:{pending:"R\xe9initialiser",online:"Mettre en ligne",onsite:"Sur place",closed:"Fermer"}[o[s.status]]})]})})]})},U=e=>{let{sellers:s,status:t}=e;return(0,a.jsxs)(v.UQ,{type:"multiple",defaultValue:["status"],children:[(0,a.jsx)(E,{sellers:s}),(0,a.jsx)(P,{}),(0,a.jsx)(T,{status:t})]})};var L=t(2272),q=t(1729),O=t(9733),D=t(8185),Q=t(402),X=t(9888),K=t(9973),Z=t(9748);let B=C.z.object({nickname:C.z.string().optional(),email:C.z.string().email({message:"Veuillez renseigner l'email de Centrale"}).optional(),floor:C.z.enum(["Autre","Adoma","Exte","T1","T2","T3","T4","T56","U1","U2","U3","U4","U56","V1","V2","V3","V45","V6","X1","X2","X3","X4","X5","X6"]).optional(),birthday:C.z.date().optional(),phone:C.z.string().refine(e=>(0,Z.y)("+"+e),{message:"Veuillez renseigner un num\xe9ro valide"}).optional(),promo:C.z.string().refine(e=>{let s=parseInt(e);return!isNaN(s)&&s>=0},{message:"Veuillez renseigner une promo valide"}).optional()});var G=t(6898),W=t(9196),Y=t(2625),H=t(2140),J=t(9921),$=t(9589),ee=t.n($);let es=e=>{let{value:s,onChange:t}=e;return(0,a.jsx)(ee(),{value:s,onChange:t,country:"fr",specialLabel:"",placeholder:"+33 6 06 06 06 06",inputClass:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",dropdownClass:"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2"})};var et=t(9495),ea=t(6465);let el=e=>{let{form:s,isLoading:t,setIsOpened:l,closeDialog:r}=e,i=["Autre","Adoma","Exte","T1","T2","T3","T4","T56","U1","U2","U3","U4","U56","V1","V2","V3","V45","V6","X1","X2","X3","X4","X5","X6"],n=new Date().getFullYear(),d=Array.from({length:5}).map((e,s)=>(n-s).toString());return(0,a.jsxs)("div",{className:"grid gap-6 mt-4",children:[(0,a.jsx)(et.L,{form:s,label:"Surnom",id:"nickname",input:e=>(0,a.jsx)(y.I,{...e})}),(0,a.jsx)(et.L,{form:s,label:"Email de Centrale",id:"email",input:e=>(0,a.jsx)(y.I,{...e,type:"email"})}),(0,a.jsxs)("div",{className:"flex flex-row gap-2 w-full",children:[(0,a.jsx)(et.L,{form:s,label:"\xc9tage",id:"floor",input:e=>(0,a.jsxs)(X.Ph,{onValueChange:e.onChange,defaultValue:e.value,children:[(0,a.jsx)(X.i4,{children:(0,a.jsx)(X.ki,{})}),(0,a.jsx)(X.Bw,{side:"top",children:i.map(e=>(0,a.jsx)(X.Ql,{value:e,children:(0,a.jsx)("div",{className:"flex items-center flex-row gap-2",children:e})},e))})]})}),(0,a.jsx)(et.L,{form:s,label:"Promo",id:"promo",input:e=>(0,a.jsxs)(X.Ph,{onValueChange:e.onChange,defaultValue:e.value,children:[(0,a.jsx)(X.i4,{children:(0,a.jsx)(X.ki,{})}),(0,a.jsx)(X.Bw,{side:"top",children:d.map(e=>(0,a.jsx)(X.Ql,{value:e,children:(0,a.jsxs)("div",{className:"flex items-center flex-row gap-2",children:["Promotion ",e]})},e))})]})})]}),(0,a.jsxs)("div",{className:"flex flex-row gap-2 w-full",children:[(0,a.jsx)(et.L,{form:s,label:"Date de naissance",id:"birthday",input:e=>(0,a.jsx)(J.M,{date:e.value,setDate:e.onChange,defaultDate:e.value||(0,ea.B)(new Date,-21)})}),(0,a.jsx)(et.L,{form:s,label:"Num\xe9ro de t\xe9l\xe9phone",id:"phone",input:e=>(0,a.jsx)(es,{...e})})]}),(0,a.jsxs)("div",{className:"flex justify-end mt-2 space-x-4",children:[(0,a.jsx)(O.z,{variant:"outline",onClick:r,disabled:t,className:"w-[100px]",children:"Annuler"}),(0,a.jsx)(N.f,{isLoading:t,className:"w-[100px]",type:"submit",children:"Modifier"})]})]})},er=e=>{var s,t,r,i,n,d,o,c;let{user:m,refetch:x}=e,{toast:f}=(0,S.pm)(),{total:p}=(0,G.T)(m.id),{total:h}=(0,W.$)(m.id),{curriculums:j}=(0,b.M)(),[g,v]=(0,l.useState)(!1),[y,C]=(0,l.useState)(!1),k=!!(null===(s=m.curriculum)||void 0===s?void 0:s.id),[V,F]=(0,l.useState)(null===(t=m.curriculum)||void 0===t?void 0:t.id),P=/^[\w\-.]*@etu(-enise)?\.ec-lyon\.fr$/;function I(e){e.stopPropagation(),v(!1)}async function A(){var e;if(C(!0),!V){C(!1),v(!1);return}if(k){let{data:s,error:t}=await (0,u.gKZ)({path:{user_id:m.id,curriculum_id:V}});e=t}else{let{data:s,error:t}=await (0,u.Vum)({path:{user_id:m.id,curriculum_id:V}});e=t}if(e){f({title:"Error",description:e.detail,variant:"destructive"}),C(!1),v(!1);return}x(),v(!1),C(!1)}let E=(0,_.cI)({resolver:(0,z.F)(B),mode:"onBlur",defaultValues:{nickname:null!==(i=m.nickname)&&void 0!==i?i:void 0,email:null!==(n=m.email)&&void 0!==n?n:void 0,floor:null!==(d=m.floor)&&void 0!==d?d:void 0,birthday:m.birthday?new Date(m.birthday):void 0,phone:null!==(o=m.phone)&&void 0!==o?o:void 0,promo:m.promo?m.promo.toString():void 0}});async function M(e){var s,t,a,l,r,i;C(!0);let n={...e,email:(null!==(t=e.email)&&void 0!==t?t:P.test(e.email))?e.email:null,promo:e.promo?parseInt(e.promo):void 0,birthday:null===(s=e.birthday)||void 0===s?void 0:s.toISOString()},{data:d,error:o}=await (0,u.ACF)({path:{user_id:m.id},body:n});if(o){f({title:"Error",description:o.detail,variant:"destructive"}),C(!1),v(!1);return}C(!1),v(!1),E.reset({nickname:null!==(a=e.nickname)&&void 0!==a?a:void 0,email:null!==(l=e.email)&&void 0!==l?l:void 0,floor:null!==(r=e.floor)&&void 0!==r?r:void 0,birthday:e.birthday?new Date(e.birthday):void 0,phone:null!==(i=e.phone)&&void 0!==i?i:void 0,promo:e.promo?e.promo.toString():void 0})}return(0,a.jsxs)("div",{className:"grid gap-12 pt-8",children:[(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)(D.ll,{className:"flex flex-row justify-between items-center",children:[(0,a.jsx)("div",{children:m.nickname?(0,a.jsxs)("span",{className:"font-bold",children:[m.nickname," (",m.firstname," ",m.name,")"]}):(0,a.jsxs)("span",{className:"font-bold",children:[m.firstname," ",m.name]})}),(0,a.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,a.jsx)("span",{className:"font-semibold text-base",children:null!==(c=null===(r=m.curriculum)||void 0===r?void 0:r.name)&&void 0!==c?c:"Pas de cursus"}),(0,a.jsx)(L.Q,{isOpened:g,setIsOpened:v,title:"Modifier le cursus",description:(0,a.jsxs)("div",{className:"grid gap-6 mt-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(Q._,{children:"Cursus"}),(0,a.jsxs)(X.Ph,{onValueChange:F,defaultValue:V,children:[(0,a.jsx)(X.i4,{children:(0,a.jsx)(X.ki,{})}),(0,a.jsx)(X.Bw,{side:"top",children:j.map(e=>(0,a.jsx)(X.Ql,{value:e.id,children:(0,a.jsx)("div",{className:"flex items-center flex-row gap-2",children:e.name})},e.id))})]})]}),(0,a.jsxs)("div",{className:"flex justify-end mt-2 space-x-4",children:[(0,a.jsx)(O.z,{variant:"outline",onClick:I,disabled:y,className:"w-[100px]",children:"Annuler"}),(0,a.jsx)(N.f,{isLoading:y,className:"w-[100px]",type:"button",onClick:A,children:"Modifier"})]}),(0,a.jsx)(q.S,{text:"Modifier l'utilisateur"}),(0,a.jsx)(w.l0,{...E,children:(0,a.jsx)("form",{onSubmit:E.handleSubmit(M),children:(0,a.jsx)(el,{form:E,setIsOpened:v,isLoading:y,closeDialog:I})})})]}),children:(0,a.jsx)(O.z,{size:"icon",variant:"outline",className:"w-[40px]",children:(0,a.jsx)(R._vs,{className:"h-5 w-5"})})})]})]}),(0,a.jsx)(K.Z,{})]}),(0,a.jsx)(H.q,{user:m,isAdmin:!0}),(0,a.jsx)(Y.X,{user:m,isAdmin:!0}),(0,a.jsx)("div",{className:"grid gap-6",children:(0,a.jsxs)(D.ll,{className:"flex flex-row w-full",children:[(0,a.jsx)("span",{className:"font-bold",children:"Reste \xe0 payer"}),(0,a.jsxs)("span",{className:"ml-auto font-semibold",children:[((null!=h?h:0)-(null!=p?p:0)).toFixed(2)," €"]})]})})]})};var ei=t(7724),en=t(7911),ed=t(5390),eo=t(1309);let ec=e=>{let{seller:s,refreshProduct:t}=e,{toast:r}=(0,S.pm)(),[i,n]=(0,l.useState)(!1),[d,o]=(0,l.useState)(!1),c=(0,_.cI)({resolver:(0,z.F)(ed.k),mode:"onBlur",defaultValues:{product_constraints:[],document_constraints:[],data_fields:[],ticket_max_use:"1",generate_ticket:!1}});async function m(e){var a;o(!0);let l={...e,available_online:"true"===e.available_online,ticket_max_use:e.ticket_max_use?parseInt(e.ticket_max_use):null,ticket_expiration:null===(a=e.ticket_expiration)||void 0===a?void 0:a.toISOString()},{data:i,error:d}=await (0,u.NxE)({path:{seller_id:s.id},body:l});if(d){r({title:"Error",description:d.detail,variant:"destructive"}),o(!1),n(!1);return}let m=e.data_fields;if(i&&m.length){let e=m.map(e=>({...e,product_id:i.id}));await Promise.all(e.map(e=>(0,u.XwI)({body:{name:e.name},path:{seller_id:s.id,product_id:i.id}})))}t(),n(!1),o(!1),c.reset()}return(0,a.jsx)(L.Q,{title:"Nouveau produit",isFullWidth:!0,description:(0,a.jsx)(w.l0,{...c,children:(0,a.jsx)("form",{onSubmit:c.handleSubmit(m),children:(0,a.jsx)(eo.G,{form:c,setIsOpened:n,isLoading:d,sellerId:s.id})})}),isOpened:i,setIsOpened:n,children:(0,a.jsxs)("div",{className:"flex flex-1 items-center justify-start py-4 font-medium border-b cursor-pointer ",children:[(0,a.jsx)(R.b9W,{className:"w-4 h-4 mr-6"}),(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Nouveau produit"}),(0,a.jsx)("div",{className:"flex grow"})]})})},eu=e=>{let{status:s,seller:t,products:r,refetchProducts:i}=e,n=(0,h.useSearchParams)(),d=n.get("sellerId"),o=n.get("userId"),{productExpansion:u,setExpandedProducts:m}=(0,en.g)();return(0,l.useEffect)(()=>{void 0===u[t.id]&&t.id===d&&r&&r.length>0&&m(t.id,r.map(e=>e.id))},[u,t.id,m,r,d]),(0,a.jsxs)(c,{value:t.id,className:"min-w-96 w-full",children:[(0,a.jsx)(ec,{seller:t,refreshProduct:i}),r.length>0?(0,a.jsx)(v.UQ,{type:"multiple",value:u[t.id],onValueChange:e=>m(t.id,e),children:r.map(e=>(0,a.jsx)(ei.A,{product:e,sellerId:t.id,userId:o,canAdd:"closed"!==s.status,canEdit:"pending"===s.status||"online"===s.status&&!e.available_online,canRemove:"pending"===s.status||"online"===s.status&&!e.available_online,canDisable:"closed"!==s.status,refreshProduct:i,isSelectable:"onsite"===s.status,isAdmin:!0},e.id))}):(0,a.jsx)("div",{className:"p-4 border border-gray-200 rounded-md",children:(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"No products found"})})]})},em=e=>{let{status:s,sellers:t,isAdmin:l}=e,r=(0,h.useSearchParams)(),i=r.get("sellerId"),{products:n,refetch:d}=j(["cdradmin","cdrrecap"].includes(null!=i?i:"")?null:i),o=r.get("userId"),{user:c,refetch:u}=(0,g.a)(o);return"cdradmin"===i&&l?(0,a.jsx)(U,{sellers:t,status:s}):"cdrrecap"===i&&l?c&&(0,a.jsx)(er,{user:c,refetch:u}):t.map(e=>(0,a.jsx)(eu,{seller:e,status:s,products:n,refetchProducts:d},e.id))};var ex=t(8087);let ef=e=>{let{status:s,sellers:t,isAdmin:l}=e,r=(0,ex.useTranslations)("ProductPart"),i=(0,h.useRouter)(),n=(0,h.useSearchParams)(),c=e=>{let s=new URLSearchParams(Array.from(n.entries()));s.set("sellerId",e);let t=s.toString();i.push("admin?".concat(t))};return(0,a.jsxs)(d,{className:"grid w-full grid-flow-row grid-cols-7",children:[t.map(e=>(0,a.jsx)(o,{value:e.id,className:"min-w-18 w-full",onClick:()=>c(e.id),children:e.name},e.id)),l&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o,{value:"cdradmin",className:"w-full min-w-18",onClick:()=>c("cdradmin"),children:"Admin"},"cdradmin"),("online"==s.status||"onsite"===s.status)&&(0,a.jsx)(o,{value:"cdrrecap",className:"w-full min-w-18",onClick:()=>c("cdrrecap"),children:r("summary")},"cdrrecap")]})]})},ep=e=>{var s;let{status:t}=e,{isAdmin:r}=f(),{sellers:i}=p(),d=(0,h.useSearchParams)(),o=(0,h.useRouter)(),c=d.get("sellerId")||(null===(s=i.at(0))||void 0===s?void 0:s.id)||(r?"cdradmin":"");return(0,l.useEffect)(()=>{if(!d.get("sellerId")&&i.length>0&&c){let e=new URLSearchParams(Array.from(d.entries()));e.set("sellerId",c);let s=e.toString();o.replace("admin?".concat(s))}},[c,o,d,i]),(0,a.jsx)("div",{className:"flex items-center justify-center p-6 min-w-96",children:c&&(0,a.jsxs)(n,{defaultValue:c,className:"w-full",children:[(0,a.jsx)(ef,{status:t,sellers:i,isAdmin:r}),(0,a.jsx)(em,{status:t,sellers:i,isAdmin:r})]})})};var eh=t(7061);let ej=()=>{let{isTokenExpired:e}=(0,x.d)(),[s,t]=(0,l.useState)([]),{isLoading:a,refetch:r}=(0,m.a)({queryKey:["users"],queryFn:async()=>{let{data:e,error:s}=await (0,u.CTm)();if(s)throw s;return e&&t(e.map(e=>{var s;return{...e,nickname:null!==(s=e.nickname)&&void 0!==s?s:""}})),e},retry:3,enabled:!e(),staleTime:1/0}),{token:i}=(0,eh.u)(),n="https://hyperion.myecl.fr".replace("http","ws")+"/cdr/users/ws";return(0,l.useEffect)(()=>{if(a)return;let e=new WebSocket(n);return e.onopen=()=>{e.send(JSON.stringify({token:i}))},e.onmessage=e=>{console.log("WebSocket message received:",e.data);let a=JSON.parse(e.data);if(a.command)switch(a.command){case"NEW_USER":var l;let r=a.data;r.nickname=null!==(l=r.nickname)&&void 0!==l?l:"",s.find(e=>e.id===r.id)?t(s.map(e=>e.id===r.id?r:e)):t([...s,r]);break;case"UPDATE_USER":let i=a.data;t(s.map(e=>e.id===i.id?i:e));break;case"WSStatus":"invalid_token"===a.data.status&&console.log("Invalid token")}},e.onclose=()=>{console.log("WebSocket connection closed")},()=>{e.close()}},[n,a,s,i]),{users:s,isLoading:a,refetch:r}};var eg=t(9055),ev=t(4971),eb=t(7592),eN=t(2468),ew=t(8165);let ey=ev.fC,eS=ev.xz;ev.ZA,ev.Uv,ev.Tr,ev.Ee,l.forwardRef((e,s)=>{let{className:t,inset:l,children:r,...n}=e;return(0,a.jsxs)(ev.fF,{ref:s,className:(0,i.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",l&&"pl-8",t),...n,children:[r,(0,a.jsx)(eb.Z,{className:"ml-auto h-4 w-4"})]})}).displayName=ev.fF.displayName,l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(ev.tu,{ref:s,className:(0,i.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...l})}).displayName=ev.tu.displayName;let eC=l.forwardRef((e,s)=>{let{className:t,sideOffset:l=4,...r}=e;return(0,a.jsx)(ev.Uv,{children:(0,a.jsx)(ev.VY,{ref:s,sideOffset:l,className:(0,i.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})})});eC.displayName=ev.VY.displayName;let ek=l.forwardRef((e,s)=>{let{className:t,inset:l,...r}=e;return(0,a.jsx)(ev.ck,{ref:s,className:(0,i.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",l&&"pl-8",t),...r})});ek.displayName=ev.ck.displayName;let ez=l.forwardRef((e,s)=>{let{className:t,children:l,checked:r,...n}=e;return(0,a.jsxs)(ev.oC,{ref:s,className:(0,i.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:r,...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(ev.wU,{children:(0,a.jsx)(eN.Z,{className:"h-4 w-4"})})}),l]})});ez.displayName=ev.oC.displayName,l.forwardRef((e,s)=>{let{className:t,children:l,...r}=e;return(0,a.jsxs)(ev.Rk,{ref:s,className:(0,i.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(ev.wU,{children:(0,a.jsx)(ew.Z,{className:"h-2 w-2 fill-current"})})}),l]})}).displayName=ev.Rk.displayName;let e_=l.forwardRef((e,s)=>{let{className:t,inset:l,...r}=e;return(0,a.jsx)(ev.__,{ref:s,className:(0,i.cn)("px-2 py-1.5 text-sm font-semibold",l&&"pl-8",t),...r})});e_.displayName=ev.__.displayName;let eV=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(ev.Z0,{ref:s,className:(0,i.cn)("-mx-1 my-1 h-px bg-muted",t),...l})});eV.displayName=ev.Z0.displayName;var eR=t(4867);function eF(e){let{column:s,title:t,className:l}=e;return s.getCanSort()?(0,a.jsx)("div",{className:(0,i.cn)("flex items-center space-x-2",l),children:(0,a.jsxs)(ey,{children:[(0,a.jsx)(eS,{asChild:!0,children:(0,a.jsxs)(O.z,{variant:"ghost",size:"sm",className:"-ml-3 h-8 data-[state=open]:bg-accent -mr-7",children:[(0,a.jsx)("span",{children:t}),"desc"===s.getIsSorted()?(0,a.jsx)(eR.veu,{className:"ml-2 h-4 w-4"}):"asc"===s.getIsSorted()?(0,a.jsx)(eR.Hf3,{className:"ml-2 h-4 w-4"}):(0,a.jsx)(eR.jnn,{className:"ml-2 h-4 w-4"})]})}),(0,a.jsxs)(eC,{align:"start",children:[(0,a.jsxs)(ek,{onClick:()=>s.toggleSorting(!1),children:[(0,a.jsx)(eR.Hf3,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Asc"]}),(0,a.jsxs)(ek,{onClick:()=>s.toggleSorting(!0),children:[(0,a.jsx)(eR.veu,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Desc"]}),(0,a.jsx)(eV,{}),(0,a.jsxs)(ek,{onClick:()=>s.toggleVisibility(!1),children:[(0,a.jsx)(eR.L52,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),"Cacher"]})]})]})}):(0,a.jsx)("div",{className:(0,i.cn)(l),children:t})}var eP=t(3541),eI=t(4175);let eA=(e,s,t)=>{let a=0;if(e.columnFiltersMeta[t]){var l,r;a=(0,eP.S1)(null===(l=e.columnFiltersMeta[t])||void 0===l?void 0:l.itemRank,null===(r=s.columnFiltersMeta[t])||void 0===r?void 0:r.itemRank)}return 0===a?eI.V2.alphanumeric(e,s,t):a},eE=(e,s,t,a)=>{let l=(0,eP.O4)(e.getValue(s),t);return a({itemRank:l}),l.passed},eM=[{accessorKey:"name",header:e=>{let{column:s}=e;return(0,a.jsx)(eF,{column:s,title:"Nom"})},cell:e=>{let{row:s}=e;return(0,a.jsx)("div",{children:s.getValue("name")})},enableSorting:!1,filterFn:"fuzzy",sortingFn:eA},{accessorKey:"firstname",header:e=>{let{column:s}=e;return(0,a.jsx)(eF,{column:s,title:"Pr\xe9nom"})},cell:e=>{let{row:s}=e;return(0,a.jsx)("div",{children:s.getValue("firstname")})},enableSorting:!1,filterFn:"fuzzy",sortingFn:eA},{accessorKey:"nickname",header:e=>{let{column:s}=e;return(0,a.jsx)(eF,{column:s,title:"Surnom"})},cell:e=>{let{row:s}=e;return(0,a.jsx)("div",{children:s.getValue("nickname")})},enableSorting:!1,filterFn:"fuzzy",sortingFn:eA},{accessorKey:"curriculum",header:e=>{let{column:s}=e;return(0,a.jsx)(eF,{column:s,title:"Cursus"})},cell:e=>{let{row:s}=e;return(0,a.jsx)("div",{className:"flex space-x-2",children:(0,a.jsx)(eg.C,{variant:"outline",children:s.getValue("curriculum")&&""!==s.getValue("curriculum")?s.getValue("curriculum").name:"Aucun cursus"})})},filterFn:(e,s,t)=>e.getValue(s)?t.includes(e.getValue(s).id):t.includes("")}],eT=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:s,className:(0,i.cn)("w-full caption-bottom text-sm",t),...l})})});eT.displayName="Table";let eU=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("thead",{ref:s,className:(0,i.cn)("[&_tr]:border-b",t),...l})});eU.displayName="TableHeader";let eL=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("tbody",{ref:s,className:(0,i.cn)("[&_tr:last-child]:border-0",t),...l})});eL.displayName="TableBody",l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("tfoot",{ref:s,className:(0,i.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...l})}).displayName="TableFooter";let eq=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("tr",{ref:s,className:(0,i.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted data-[state=selected]:font-semibold",t),...l})});eq.displayName="TableRow";let eO=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("th",{ref:s,className:(0,i.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...l})});eO.displayName="TableHead";let eD=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("td",{ref:s,className:(0,i.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...l})});eD.displayName="TableCell",l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("caption",{ref:s,className:(0,i.cn)("mt-4 text-sm text-muted-foreground",t),...l})}).displayName="TableCaption";var eQ=t(3514);function eX(e){let{table:s}=e;return(0,a.jsxs)("div",{className:"flex items-center justify-between px-2",children:[(0,a.jsxs)("div",{className:"flex-1 text-sm text-muted-foreground min-w-[110px]",children:[s.getFilteredSelectedRowModel().rows.length," s\xe9lectionn\xe9s"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 lg:space-x-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 min-w-[140px]",children:[(0,a.jsxs)(X.Ph,{value:"".concat(s.getState().pagination.pageSize),onValueChange:e=>{s.setPageSize(Number(e))},children:[(0,a.jsx)(X.i4,{className:"h-8 w-[70px] min-w-[70px]",children:(0,a.jsx)(X.ki,{placeholder:s.getState().pagination.pageSize})}),(0,a.jsx)(X.Bw,{side:"top",children:[10,25,50,100].map(e=>(0,a.jsx)(X.Ql,{value:"".concat(e),children:e},e))})]}),(0,a.jsx)("p",{className:"text-sm font-medium",children:"par page"})]}),(0,a.jsxs)("div",{className:"flex w-[100px] items-center justify-center text-sm font-medium",children:["Page ",s.getState().pagination.pageIndex+1," sur"," ",s.getPageCount()]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(O.z,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>s.setPageIndex(0),disabled:!s.getCanPreviousPage(),children:[(0,a.jsx)("span",{className:"sr-only",children:"Go to first page"}),(0,a.jsx)(eR.kRt,{className:"h-4 w-4"})]}),(0,a.jsxs)(O.z,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>s.previousPage(),disabled:!s.getCanPreviousPage(),children:[(0,a.jsx)("span",{className:"sr-only",children:"Go to previous page"}),(0,a.jsx)(eR.wyc,{className:"h-4 w-4"})]}),(0,a.jsxs)(O.z,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>s.nextPage(),disabled:!s.getCanNextPage(),children:[(0,a.jsx)("span",{className:"sr-only",children:"Go to next page"}),(0,a.jsx)(eR.XCv,{className:"h-4 w-4"})]}),(0,a.jsxs)(O.z,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>s.setPageIndex(s.getPageCount()-1),disabled:!s.getCanNextPage(),children:[(0,a.jsx)("span",{className:"sr-only",children:"Go to last page"}),(0,a.jsx)(eR.yr4,{className:"h-4 w-4"})]})]})]})]})}var eK=t(4063),eZ=t(23);function eB(e){return e.nickname?e.firstname+" "+e.name+" ("+e.nickname+")":e.firstname+" "+e.name}let eG=()=>{let{toast:e}=(0,S.pm)(),[s,t]=(0,l.useState)(!1);async function r(){if(t(!0),!o||!h){t(!1);return}let{data:s,error:a}=await (0,u.Vum)({path:{user_id:h.id,curriculum_id:o}});if(a){e({title:"Error",description:a.detail,variant:"destructive"}),t(!1),n(!1);return}j(void 0),x(void 0),n(!1),t(!1)}let[i,n]=(0,l.useState)(!1),{curriculums:d}=(0,b.M)(),[o,c]=(0,l.useState)(d.length>0?d[0].id:void 0),[m,x]=(0,l.useState)(void 0),[f,p]=(0,l.useState)([]),[h,j]=(0,l.useState)(void 0);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(O.z,{variant:"secondary",onClick:()=>n(!0),className:"h-8",children:[(0,a.jsx)(R.HQD,{className:"mr-2 h-4"}),"Ajouter"]}),(0,a.jsx)(L.Q,{isOpened:i,setIsOpened:n,title:"Ajouter un cursus \xe0 un utilisateur",description:(0,a.jsxs)("div",{className:"grid gap-6 mt-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(Q._,{children:"Cursus"}),(0,a.jsxs)(X.Ph,{onValueChange:c,defaultValue:o,children:[(0,a.jsx)(X.i4,{children:(0,a.jsx)(X.ki,{})}),(0,a.jsx)(X.Bw,{side:"top",children:d.map(e=>(0,a.jsx)(X.Ql,{value:e.id,children:(0,a.jsx)("div",{className:"flex items-center flex-row gap-2",children:e.name})},e.id))})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(Q._,{children:"Utilisateur"}),(0,a.jsx)(y.I,{type:"text",placeholder:h?eB(h):"Chercher un utilisateur",onChange:e=>{x(e.target.value),j(void 0),(0,u.zSX)({query:{query:e.target.value}}).then(e=>{p(e.data||[])})},value:h?eB(h):m}),(0,a.jsx)(eK.mY,{children:(0,a.jsx)(eZ.x,{className:"",children:f.map(e=>(0,a.jsx)(eK.di,{value:e.id,onSelect:s=>{j(e),p([])},children:eB(e)},e.id))})}),(0,a.jsxs)("div",{className:"flex justify-end mt-2 space-x-4",children:[(0,a.jsx)(O.z,{variant:"outline",onClick:()=>n(!1),disabled:s,className:"w-[100px]",children:"Annuler"}),(0,a.jsx)(N.f,{isLoading:s,className:"w-[100px]",type:"button",disabled:!h||!o,onClick:r,children:"Ajouter"})]})]})]})})]})};var eW=t(1413),eY=t(4008);function eH(e){let{column:s,title:t,options:l}=e,r=null==s?void 0:s.getFacetedUniqueValues(),n=new Set(null==s?void 0:s.getFilterValue());return(0,a.jsxs)(eW.J2,{children:[(0,a.jsx)(eW.xo,{asChild:!0,children:(0,a.jsxs)(O.z,{variant:"outline",size:"sm",className:"h-8 border-dashed",children:[(0,a.jsx)(eY.Yv7,{className:"mr-2 h-4 w-4"}),t,(null==n?void 0:n.size)>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(K.Z,{orientation:"vertical",className:"mx-2 h-4"}),(0,a.jsx)(eg.C,{variant:"secondary",className:"rounded-sm px-1 font-normal lg:hidden",children:n.size}),(0,a.jsx)("div",{className:"hidden space-x-1 lg:flex",children:n.size>2?(0,a.jsxs)(eg.C,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:[n.size," s\xe9lectionn\xe9s"]}):l.filter(e=>n.has(e.value)).map(e=>(0,a.jsx)(eg.C,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:e.label},e.value))})]})]})}),(0,a.jsx)(eW.yk,{className:"w-[200px] p-0",align:"start",children:(0,a.jsxs)(eK.mY,{children:[(0,a.jsx)(eK.sZ,{placeholder:t}),(0,a.jsxs)(eK.e8,{children:[(0,a.jsx)(eK.rb,{children:"Aucun r\xe9sultat"}),(0,a.jsx)(eK.fu,{children:l.map(e=>{let t=n.has(e.value);return(0,a.jsxs)(eK.di,{onSelect:()=>{t?n.delete(e.value):n.add(e.value);let a=Array.from(n);null==s||s.setFilterValue(a.length?a:void 0)},children:[(0,a.jsx)("div",{className:(0,i.cn)("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",t?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:(0,a.jsx)(eR.nQG,{className:(0,i.cn)("h-4 w-4")})}),e.icon&&(0,a.jsx)(e.icon,{className:"mr-2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{children:e.label}),(null==r?void 0:r.get(e.value))&&(0,a.jsx)("span",{className:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs",children:r.get(e.value)})]},e.value)})}),n.size>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eK.zz,{}),(0,a.jsx)(eK.fu,{children:(0,a.jsx)(eK.di,{onSelect:()=>null==s?void 0:s.setFilterValue(void 0),className:"justify-center text-center",children:"Supprimer les filtres"})})]})]})]})})]})}let eJ=e=>{switch(e){case"name":return"Nom";case"firstname":return"Pr\xe9nom";case"nickname":return"Surnom";case"curriculum":return"Cursus";default:return e}};function e$(e){let{table:s}=e;return(0,a.jsxs)(ey,{children:[(0,a.jsx)(ev.$F,{children:(0,a.jsxs)(O.z,{variant:"outline",size:"sm",className:"hidden h-8 lg:flex",children:[(0,a.jsx)(eR.hsZ,{className:"mr-2 h-4 w-4"}),"Colonnes"]})}),(0,a.jsxs)(eC,{align:"end",className:"w-[180px]",children:[(0,a.jsx)(e_,{children:"Activer les colonnes"}),(0,a.jsx)(eV,{}),s.getAllColumns().filter(e=>void 0!==e.accessorFn&&e.getCanHide()).map(e=>(0,a.jsx)(ez,{checked:e.getIsVisible(),onCheckedChange:s=>e.toggleVisibility(!!s),children:eJ(e.id)},e.id))]})]})}function e0(e){let{table:s,globalFilter:t,setGlobalFilter:l}=e,{curriculums:r}=(0,b.M)();return(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex flex-1 items-center space-x-2",children:[(0,a.jsx)(y.I,{placeholder:"Filtrer",value:t,onChange:e=>l(e.target.value),className:"h-8 w-[150px] lg:w-[250px]"}),s.getColumn("curriculum")&&(0,a.jsx)(eH,{column:s.getColumn("curriculum"),title:"Cursus",options:r.map(e=>({value:e.id,label:e.name})).concat({value:"",label:"Aucun cursus"})}),(0,a.jsx)(eG,{})]}),(0,a.jsx)(e$,{table:s})]})}function e1(e){var s;let{columns:t,data:r}=e,i=(0,h.useRouter)(),n=(0,h.useSearchParams)(),[d,o]=l.useState({}),[c,u]=l.useState({}),[m,x]=l.useState([]),[f,p]=l.useState(""),[j,g]=l.useState([]),v=n.get("userId"),b=(0,eQ.b7)({data:r,columns:t,filterFns:{fuzzy:eE},state:{columnFilters:m,globalFilter:f,sorting:j,columnVisibility:c,rowSelection:d},enableRowSelection:!0,onRowSelectionChange:o,onSortingChange:g,onColumnFiltersChange:x,onColumnVisibilityChange:u,getCoreRowModel:(0,eI.sC)(),getFilteredRowModel:(0,eI.vL)(),getPaginationRowModel:(0,eI.G_)(),getSortedRowModel:(0,eI.tj)(),getFacetedRowModel:(0,eI.o6)(),getFacetedUniqueValues:(0,eI.JG)(),globalFilterFn:"fuzzy",onGlobalFilterChange:p});function N(e){b.getSelectedRowModel().rows.length&&o({});let s=e.original.id;if(s===v){let e=new URLSearchParams(Array.from(n.entries()));e.delete("userId");let s=e.toString();i.push("/admin?".concat(s));return}let t=new URLSearchParams(Array.from(n.entries()));t.set("userId",s);let a=t.toString();i.push("/admin?".concat(a)),e.toggleSelected(!0)}return l.useEffect(()=>{if(v&&!b.getIsSomeRowsSelected()){let e=r.findIndex(e=>e.id===v);if(-1!==e){let s=b.getRow(e.toString(),!0);s&&s.toggleSelected(!0)}}},[b.getRowModel().rows,v]),(0,a.jsxs)("div",{className:"space-y-4 w-full",children:[(0,a.jsx)(e0,{table:b,globalFilter:f,setGlobalFilter:p}),(0,a.jsx)("div",{className:"rounded-md border",children:(0,a.jsxs)(eT,{children:[(0,a.jsx)(eU,{children:b.getHeaderGroups().map(e=>(0,a.jsx)(eq,{children:e.headers.map(e=>(0,a.jsx)(eO,{colSpan:e.colSpan,children:e.isPlaceholder?null:(0,eQ.ie)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,a.jsx)(eL,{children:(null===(s=b.getRowModel().rows)||void 0===s?void 0:s.length)?(0,a.jsxs)(a.Fragment,{children:[b.getSelectedRowModel().rows.filter(e=>!b.getRowModel().rows.includes(e)).map(e=>(0,a.jsx)(eq,{"data-state":"selected",onClick:()=>N(e),children:e.getVisibleCells().map(e=>(0,a.jsx)(eD,{children:(0,eQ.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)),b.getRowModel().rows.map(e=>(0,a.jsx)(eq,{"data-state":e.getIsSelected()&&"selected",onClick:()=>N(e),children:e.getVisibleCells().map(e=>(0,a.jsx)(eD,{children:(0,eQ.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id))]}):(0,a.jsx)(eq,{children:(0,a.jsx)(eD,{colSpan:t.length,className:"h-24 text-center",children:"Pas de r\xe9sultat"})})})]})}),(0,a.jsx)(eX,{table:b})]})}let e2=()=>{let{users:e}=ej();return(0,a.jsx)("div",{className:"flex items-center justify-center p-6 min-w-96",children:(0,a.jsx)(e1,{columns:eM,data:e})})};var e4=t(1322),e5=t(1505);let e3=e=>{let{className:s,...t}=e;return(0,a.jsx)(e5.eh,{className:(0,i.cn)("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",s),...t})},e8=e5.s_,e6=e=>{let{withHandle:s,className:t,...l}=e;return(0,a.jsx)(e5.OT,{className:(0,i.cn)("relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",t),...l,children:s&&(0,a.jsx)("div",{className:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border",children:(0,a.jsx)(e4.Z,{className:"h-2.5 w-2.5"})})})};var e9=t(9079),e7=()=>{let{setSize:e,size:s}=(0,e9.R)(),{user:t,isAdmin:r}=f(),{sellers:i}=p(),n=(0,h.useRouter)(),{status:d}=M();return(0,l.useEffect)(()=>{var e;if(!t)return;let s=null===(e=t.groups)||void 0===e?void 0:e.map(e=>e.id),a=null==s?void 0:s.some(e=>i.some(s=>s.group_id===e));r||a||n.push("/")},[r,n,i,t]),(0,l.useEffect)(()=>{(null==d?void 0:d.status)&&("onsite"===d.status?e(50):e(100))},[d,e]),(0,a.jsx)("main",{className:"grid flex-1 items-start gap-4 p-4 sm:px-6 sm:py-0 md:gap-8 mt-8",children:(0,a.jsx)(l.Suspense,{fallback:(0,a.jsx)("div",{children:"Loading..."}),children:d&&(0,a.jsx)(D.Zb,{children:"onsite"===d.status||r&&"online"===d.status?(0,a.jsxs)(e3,{direction:"horizontal",children:[(0,a.jsx)(e8,{defaultSize:100-s,minSize:10,children:(0,a.jsx)(e2,{})}),(0,a.jsx)(e6,{withHandle:!0}),(0,a.jsx)(e8,{defaultSize:s,minSize:10,onResize:e,children:(0,a.jsx)(ep,{status:d})})]}):(0,a.jsx)(ep,{status:d})})})})}},1729:function(e,s,t){"use strict";t.d(s,{S:function(){return l}});var a=t(7437);t(2265);let l=e=>{let{text:s}=e;return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,a.jsx)("span",{className:"w-full border-t"})}),(0,a.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,a.jsx)("span",{className:"bg-background px-2 text-muted-foreground",children:s})})]})};l.displayName="TextSeparator"}},function(e){e.O(0,[310,516,422,8,622,213,951,417,341,971,23,744],function(){return e(e.s=9261)}),_N_E=e.O()}]);